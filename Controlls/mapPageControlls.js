const albaniaMap = {
  cities:{
    ALB1529: {
      name: "Tirana",
      image_url: "https://wallpapercave.com/wp/wp2281648.jpg",
      idescription: "The land of Xhensil",
      star_rating: "5",
      centre_x: "341.3275",
      centre_y: "1019.8187",
      points_of_interest: {
        SheshiSkenderbej: {
          name: "Sheshi Skënderbej",
          image_url: "https://3.bp.blogspot.com/-zU5gXZnB8Ac/Wni_IdKZoNI/AAAAAAAARmc/YdBwJTXUU9MxJfq6wLDqId_vSYDmBfxpQCLcBGAs/s1600/tirana-centro-1024x683_1517812151-7242742.jpg",
        },
        Tajvani: {
          name: "Tajvani",
          image_url: "https://photos.wikimapia.org/p/00/00/78/70/60_big.jpg",
        },
        BunkArt: {
          name: "BunkArt",
          image_url: "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/0e/37/8e/ac/la-splendida-cupola-ingresso.jpg?w=1200&h=-1&s=1",
        },
        MuzeuHistorikKombetar: {
          name: "Muzeu Historik Kombëtar",
          image_url: "https://tirana.al/uploads/images/points-of-interes/20191224130459_national-historical-museum-tirana-rreg.jpg",
        },
        Piramida: {
          name: "Piramida",
          image_url: "https://api.mvrdv.com/media/uploads/project/312/Pyramid%20Tirana%2002%20_%20%20MVRDV.jpg?width=1920",
        }
      }
    },
    ALB1494: {
      name: "Durrës",
      image_url: "https://t4.ftcdn.net/jpg/04/75/03/21/360_F_475032122_0yUvBrPd318xEJJ5g2rqsEM83c0p6mnJ.jpg",
      description: "The land of Xhensil",
      star_rating: "5",
      centre_x: "121.3275",
      centre_y: "979.8187",
      points_of_interest:{
        Amfiteatri: {
          name: "Amfiteatri",
          image_url: "https://pbs.twimg.com/media/DslfcfXWkAEHa-d.jpg",
        },
        Vila_Zogu: {
          name: "Vila Zogut",
          image_url: "https://upload.wikimedia.org/wikipedia/commons/1/19/Royal_villa_of_Durres_01.jpg",
        },
        Kalaja_e_Durresit: {
          name: "Kalaja e Durrësit",
          image_url: "https://guesthousehoxha.files.wordpress.com/2016/03/durres-castel.jpg",
        },
        Muzeu_Kombetar_Arkeologjik: {
          name: "Muzeu Kombëtar Arkeologjik",
          image_url: "https://kultura.gov.al/3dsite/wp-content/uploads/2019/08/Muzeu-Arkeologjik-Durres.jpg",
        }
      }
    },
    ALB1495:{
      name: "Fier",
      image_url: "https://cdn.albanianews.al/wp-content/uploads/2018/05/centro-di-fier.jpg",
      description: "The land of Xhensil",
      star_rating: "4",
      centre_x: "181.3275",
      centre_y: "1419.8187",
      points_of_interest:{
        Apollonia: {
          name: "Apollonia",
          image_url: "https://i0.wp.com/feel-albania.com/wp-content/uploads/2019/07/Apollnia-Fier.jpg?fit=1800%2C1192&ssl=1",
        },
      }
    },
    ALB1498: {
      name: "Shkodër",
      image_url: "https://cdn.getyourguide.com/img/tour/62b1c2ccb4df6.jpeg/146.jpg",
      description: "The land of Xhensil",
      star_rating: "5",
      centre_x: "167.3275",
      centre_y: "419.8187",
      points_of_interest:{
        Kalaja_e_Rozafes: {
          name: "Kalaja e Rozafës",
          image_url: "https://www.kultplus.com/wp-content/uploads/2017/07/kalaja_rozafa-1-696x464-696x430.jpg",
        },
        Shiroke: {
          name: "Shiroke",
          image_url: "https://d29mtkonxnc5fw.cloudfront.net/images/oV4sLqq-gEd6luuZuOUjgQ_cover.jpg",
        },
        Xhamia_e_Plumbit: {
          name: "Xhamia e Plumbit",
          image_url: "https://www.kultplus.com/wp-content/uploads/2019/03/A29AC2B5C900DB5902EA0796DB371073-696x461-696x430.jpg",
        },
        Liqeni_i_Shkodres: {
          name: "Liqeni i Shkodrës",
          image_url: "https://media-cdn.tripadvisor.com/media/photo-s/19/a3/d9/e0/lake-skadar-albanian.jpg",
        },
        Katedralia_e_Shtjefnit:{
          name: "Katedralia e Shën Shtjefnit",
          image_url: "https://www.iett.al/wp-content/uploads/2020/11/107594964_3245568822177339_6185131487311686327_o-1100x564.jpg",
        }
      }
    },
    ALB1502: {
      name: "Kukës",
      image_url: "https://www.imalbania.com/kosova/wp-content/uploads/2022/05/1653546360_kukes-1.png",
      description: "The land of Xhensil",
      star_rating: "2",
      centre_x: "661.3275",
      centre_y: "434.8187",
      points_of_interest:{
        Liqeni_i_Fierzes: {
          name: "Liqeni i Fierzës",
          image_url: "https://photos.wikimapia.org/p/00/01/09/14/78_big.jpg",
        }
      }
    },
    ALB1504: {
      name: "Vlorë",
      image_url: "https://storage.googleapis.com/albania-travel-guide/2022/07/Vlore-Albania-Travel-Guide-44-960x540.jpg",
      description: "The land of Xhensil",
      star_rating: "4",
      centre_x: "141.3275",
      centre_y: "1609.8187",
      points_of_interest:{
        Monumenti_i_Pavarësisë: {
          name: "Monumenti i Pavarësisë",
          image_url: "https://img1.advisor.travel/1200x630px-Independence_Monument_Albania_3.jpg",
        },
        Xhamia_Muradies: {
          name: "Xhamia Muradies",
          image_url: "https://www.iett.al/wp-content/uploads/2020/12/xhamia_muradies_4.jpg",
        },
        Muzeu_Kombetar_i_Pavarsise:{
          name: "Muzeu Pavarësisë",
          image_url: "https://apollon.tv/app/uploads/2022/12/vlore.jpg",
        },
        Logara:{
          name: "Logara",
          image_url: "https://nationalparks-15bc7.kxcdn.com/images/parks/llogara/Llogara%20National%20Park.jpg",
        },
        Shpella_e_Piratit:{
          name: "Shpella e Piratit",
          image_url: "https://www.albinfo.at/wp-content/uploads/2020/09/img_3744.jpg",
        },
        Kalaja_Ali_Pashes:{
          name: "Kalaja Ali Pashës",
          image_url: "https://upload.wikimedia.org/wikipedia/commons/d/d3/Kalaja_e_Ali_Pashe_Tepelenes_%2C_porto_palermo.jpg",
        }
      }
    },
    ALB1521: {
      name: "Korçë",
      image_url: "https://media.gettyimages.com/id/454325829/photo/albania-korca.jpg?s=612x612&w=gi&k=20&c=zgk-E395dyWKbzzMDHroPQwTiFT-nz2zXiOQcp4S-jM=",
      description: "The land of Xhensil",
      star_rating: "5",
      centre_x: "841.3275",
      centre_y: "1509.8187",
      points_of_interest:{
        PAzari_i_Vjeter:{
          name: "Pazari i Vjetër",
          image_url: "https://telegrafi.com/wp-content/uploads/2018/11/korce-1-1-780x439.jpg",
        },
        Muzeu_Kombetar_i_Artit:{
          name: "Muzeu Kombëtar i Artit",
          image_url: "https://kultura.gov.al/3dsite/wp-content/uploads/2019/09/Muzeu-Artit-Mesjetar-Korce.jpg",
        },
        Voskopoje:{
          name: "Voskopojë",
          image_url: "https://media-cdn.tripadvisor.com/media/photo-s/1a/d7/b3/42/let-it-snow.jpg",
        },
        Dardhe:{
          name: "Dardhë",
          image_url: "https://cdn.albanianews.al/wp-content/uploads/2021/05/dardhe-korce.jpg",
        },
        Bulevardi_Shen_Gjergjit:{
          name: "Bulevardi Shen Gjergjit",
          image_url: "https://farm7.staticflickr.com/6021/5919001117_d6492f3880.jpg",
        }
      }
    },
    ALB1523: {
      name: "Berat",
      image_url: "https://i.pinimg.com/originals/18/34/05/1834052556450b32926b0ca6614f04af.jpg",
      description: "The land of Xhensil",
      star_rating: "1",
      centre_x: "371.3275",
      centre_y: "1459.8187",
      points_of_interest:{
        Kalaja_e_Beratit:{
          name: "Kalaja e Beratit",
          image_url: "https://ata.gov.al/wp-content/uploads/2020/12/a911bdb5ff4fdaf1f10962acd3004a08.jpg",
        },
        Muzeu_Etnografik:{
          name: "Muzeu Etnografik",
          image_url: "https://i0.wp.com/muzeumet-berat.al/wp-content/uploads/2019/01/01-Muzeu-Etnografik-1-scaled.jpg?fit=768%2C509&ssl=1",
        },
        Ura_e_Gorices:{
          name: "Ura e Gorices",
          image_url: "https://www.iett.al/wp-content/uploads/2020/11/6a6b2b5e86d204e155f4c8e87cd517b4.jpg",
        },
        Xhamia_e_Kuqe:{
          name: "Xhamia e Kuqe",
          image_url: "https://img1.advisor.travel/1314x680px-Red_Mosque_Berat_12.jpg",
        }
      }
    },
    ALB1524: {
      name: "Elbasan",
      image_url: "https://thumbs.dreamstime.com/b/walls-elbasan-castle-albania-illuminated-mighty-tower-th-century-evening-photo-249458336.jpg",
      description: "The land of Xhensil",
      star_rating: "3",
      centre_x: "451.3275",
      centre_y: "1149.8187",
      points_of_interest:{
        Kalaja_e_Elbasanit:{
          name: "Kalaja e Elbasanit",
          image_url: "https://www.intoalbania.com/wp-content/uploads/2018/01/EL_ARC_MURET-E-KALASE-DHE-SAHATI_04-e1521557417466.jpg",
        },
        Liqeni_Dushkut:{
          name: "Liqeni i Dushkut",
          image_url: "https://kohajone.com/wp-content/uploads/2021/10/d2.jpg",
        },
        Parku_Nacional_Shebenik:{
          name: "Parku Nacional Shebenik",
          image_url: "https://www.nature-experience-albania.com/wp-content/uploads/bushtrica-river-photo-shebenik-jabllanice-national-park.jpg",
        }
      }
    },
    ALB1525: {
      name: "Gjirokastër",
      image_url: "https://t3.ftcdn.net/jpg/03/19/53/18/360_F_319531833_H55XhmuCdi6HGekkO7JhW95W1R8Yg3an.jpg",
      description: "The land of Xhensil",
      star_rating: "5",
      centre_x: "491.3275",
      centre_y: "1899.8187",
      points_of_interest:{
        Kalaja_e_Gjirokastres:{
          name: "Kalaja e Gjirokastrës",
          image_url: "https://media-cdn.tripadvisor.com/media/attractions-splice-spp-720x480/07/87/2f/bc.jpg",
        },
        Shtepia_e_Zekateve:{
          name: "Shtëpia e Zekatëve",
          image_url: "https://www.visit-gjirokastra.com/wp-content/uploads/2019/03/zekate.jpg",
        },
        Pazari_Gjirokastres:{
          name: "Pazari i Gjirokastrës",
          image_url: "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/1a/9a/c3/86/caption.jpg?w=1200&h=-1&s=1",
        },
      }
    },
    ALB1526: {
      name: "Dibër",
      image_url: "https://albanianpost.com/wp-content/uploads/2021/07/DIBER-COVER.jpg",
      description: "The land of Xhensil",
      star_rating: "2",
      centre_x: "651.3275",
      centre_y: "689.8187",
      points_of_interest:{
        Parku_Kombetar_i_Lurës:{
          name: "Parku Kombëtar i Lurës",
          image_url: "https://radiotravel.al/wp-content/uploads/2018/11/lura-2-1.jpg",
        },
        Liqeni_Shkopetit:{
          name: "Liqeni i Shkopetit",
          image_url: "https://shqiptarja.com/uploads/780x440/1533363032_ulza.jpg",
        },
        Maja_Korabit:{
          name: "Maja e Korabit",
          image_url: "https://upload.wikimedia.org/wikipedia/commons/b/bf/Korab_%28detail%29.jpg",
        }
      }
    },
    ALB1528: {
      name: "Lezhë",
      image_url: "https://t3.ftcdn.net/jpg/04/91/03/74/360_F_491037469_e5dLNiL9Ufq2R4Al5CQuH7wBVmzRRq27.jpg",
      description: "The land of Xhensil",
      star_rating: "4",
      centre_x: "231.3275",
      centre_y: "639.8187",
      points_of_interest:{
        Kalaja_e_Lezhes:{
          name: "Kalaja e Lezhës",
          image_url: "https://www.intoalbania.com/wp-content/uploads/2017/12/LE_ARC_KALAJA-E-LEZHES_01-e1521563410804.jpg",
        },
        Plazhi_i_Shengjinit:{
          name: "Plazhi i Shëngjinit",
          image_url: "https://ata.gov.al/wp-content/uploads/2020/05/auto_shengjin_31498041589.jpg",
        },
      }
    }
  }
}

const allCities = document.querySelectorAll(".map-city");

const cardsContainer = document.querySelector(".location-cards-container");
const mapLocationCard = document.querySelector(".map-location-card");
cardsContainer.removeChild(mapLocationCard);

function cloneCityCard(city){
  let newCard = mapLocationCard.cloneNode(true);
  newCard.id = city;
  newCard.querySelector(".map-location-card-name").textContent = albaniaMap.cities[city].name;
  newCard.querySelector(".map-location-card-image").src = albaniaMap.cities[city].image_url;
  newCard.querySelector(".google-map-link").href = `https://www.google.com/maps/place/${albaniaMap.cities[city].name}`;
  for(let i = 0; i < albaniaMap.cities[city].star_rating; i++){
      newCard.querySelector(".map-location-card-place-rating").innerHTML += `<span class="material-symbols-outlined">star</span>`;
  }
  return newCard;
}

function displayPointsOfInterest(city){
  cardsContainer.innerHTML = "";

  cardsContainer.appendChild(cloneCityCard(city));

  for(let point in albaniaMap.cities[city].points_of_interest){
      let newCard = mapLocationCard.cloneNode(true);
      newCard.id = point;
      newCard.querySelector(".map-location-card-name").textContent = albaniaMap.cities[city].points_of_interest[point].name;
      newCard.querySelector(".map-location-card-image").src = albaniaMap.cities[city].points_of_interest[point].image_url;
      
      let placeAnkor = newCard.querySelector(".map-location-card-place-ancor");
      console.log(placeAnkor);
      placeAnkor.innerHTML = "";

      
      cardsContainer.appendChild(newCard);
  }
}

function changeColorOfCity(city){
  let previousCity = document.querySelector(".clicked-city");
    if(previousCity){
        previousCity.classList.toggle("clicked-city");
    }
    city.classList.toggle("clicked-city");
}

function zoomInCity(city){
    let cityId = city.id;
    let cityElement = document.querySelector(`#${cityId}`);
    let cityElementPosition = cityElement.getBoundingClientRect();
    let cityElementCenterX = cityElementPosition.x + cityElementPosition.width/2;
    let cityElementCenterY = cityElementPosition.y + cityElementPosition.height/2;
    let mapContainer = document.querySelector(".map-container");
    let mapContainerPosition = mapContainer.getBoundingClientRect();
    let mapContainerCenterX = mapContainerPosition.x + mapContainerPosition.width/2;
    let mapContainerCenterY = mapContainerPosition.y + mapContainerPosition.height/2;
    let mapContainerCenterXOffset = mapContainerCenterX - cityElementCenterX;
    let mapContainerCenterYOffset = mapContainerCenterY - cityElementCenterY;
    mapContainer.style.transform = `translate(${mapContainerCenterXOffset}px, ${mapContainerCenterYOffset}px) scale(3)`;
}

function zoomOutCity(){
    let mapContainer = document.querySelector(".map-container");
    mapContainer.style.transform = `translate(0px, 0px) scale(1)`;
}

function addCartForEachCity(){
  for(let city in albaniaMap.cities){
      cardsContainer.appendChild(cloneCityCard(city));
  }
}

function displayCityLocationOnMap(){
  const map = document.getElementById("map-svg");
  const circle = document.querySelector("circle");
  const text = document.querySelector("text");
  console.log(map);
  console.log(circle);
  map.removeChild(circle);
  map.removeChild(text);
  console.log(map.contains(circle));
  
  for(let city in albaniaMap.cities){
      let newCircle = circle.cloneNode(true);
      let newText = text.cloneNode(true);
      newCircle.id = city;
      newText.id = city;
      newCircle.setAttribute("cx", albaniaMap.cities[city].centre_x);
      newText.setAttribute("x", (parseFloat(albaniaMap.cities[city].centre_x) - 50));
      newCircle.setAttribute("cy", albaniaMap.cities[city].centre_y);
      newText.setAttribute("y", (parseFloat(albaniaMap.cities[city].centre_y) + 60));
      newText.textContent = albaniaMap.cities[city].name;
      map.appendChild(newCircle);
      map.appendChild(newText);
  }
}

allCities.forEach(city => {
    city.addEventListener("click", () => {
        // console.log(albaniaMap.cities[city.id].name);
        changeColorOfCity(city);
        // zoomInCity(city);
        displayPointsOfInterest(city.id);
    });
});

addCartForEachCity();




displayCityLocationOnMap();